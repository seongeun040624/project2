/*  
 * 20141103 박도식  
 * 20161222 수정
 */


$(document).ready(function() {
	
	 searchForm = $('#totalSearchForm');
	 targetSiteId = $('#targetSiteId').val();
	 coll_id = $('#coll_id').val();
	 popwordCollection = $('#popwordCollection').val();
	
	$(".link_list > .open_select").each(function(i) {
		var parent = $(".link_list");
		var box = $(".link_list .box_select");
		$(this).click(function() {
			if($(box[i]).css("display") == "block") {
				$(box[i]).hide();
			} else {
				$(box[i]).show();
				$(box.not(box[i])).hide();
			}
		});
	});


	$(".link_list02 > .open_select").click(function() {
		$(".service_wrap").toggle();
		$(".link_list02").toggleClass("on");
	});

});



//등록일자 직접입력
function detailDate(){
	var searchForm = document.forms.totalSearchForm;
	var detailDiv = document.getElementById("detailDate");
	if ( detailDiv.style.display == "none" ){
		detailDiv.style.display = "block";
	}else if(detailDiv.style.display == "block" ){
		detailDiv.style.display = "none" ;
	}
	var searchForm = document.forms.totalSearchForm;

	if(searchForm.range.value == "U" ){
	//	alert("aaaa");
		var startDateView = document.getElementById("startDateView");
		if(startDateView.value == "1970/01/01"){
			var startDate = "";
			var currentDate = new Date();
			startDate = getAddDay(currentDate, -364);

			var year = startDate.getFullYear();
			var month = startDate.getMonth()+1; 
			var day = startDate.getDate();

			if (parseInt(month) < 10) {
				month = "0" + month;
			}

			if (parseInt(day) < 10) {
				day = "0" + day;
			}

			startDate = year + "/" + month + "/" + day;			
			startDateView.value = startDate;
		}
	}

}

// 달력 이미지 옆 버튼
function calendar(id){
	var calendar_id =  document.getElementById(id);
	calendar_id.focus();
}


// 직접입력- 날짜적용
function goDetailDate(){
	var startDateView = document.getElementById("startDateView");
	var endDateView = document.getElementById("endDateView");

	var searchForm = document.forms.totalSearchForm;
	searchForm.startDate.value=startDateView.value;
	searchForm.endDate.value=endDateView.value;
	searchForm.range.value = "U";
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;

	onSubmit();

}

// 용어사전
function goterms(query){
	var searchForm = document.forms.totalSearchForm;
	searchForm.query.value = query;
	searchForm.collectionGbn.value = "7";
	searchForm.collection.value = "terms";
	searchForm.viewCount.value="10";
	searchForm.startCount.value="0";
	searchForm.targetSiteId.value = targetSiteId;



	onSubmit();

}

// 상세검색
function detailView(){
	var searchForm = document.forms.totalSearchForm;
	var detailDiv = document.getElementById("detailSearch");
	if ( detailDiv.style.display == "none" ){
		detailDiv.style.display = "block";
	}else if(detailDiv.style.display == "block" ){
		detailDiv.style.display = "none" ;
	}


}

// 상세검색 닫기
function detailSearchSearch(gbn){
	if(gbn ==  "go"){
		var searchForm = document.forms.totalSearchForm;
		searchForm.matchQuery.value = document.getElementById("dtxt1").value;
		searchForm.indexOfQuery.value = document.getElementById("dtxt2").value;
		searchForm.exceptQuery.value = document.getElementById("dtxt3").value;
		onSubmit();
		searchForm.targetSiteId.value = targetSiteId;
	}else if(gbn == "clear"){
		detailView();
	}

}


// 상세검색화면 input 초기화
function reset(){
	var matchQuery_view = document.getElementById("dtxt1");
	var indexOfQuery_view = document.getElementById("dtxt2");
	var exceptQuery_view = document.getElementById("dtxt3");
	matchQuery_view.value = "";
	indexOfQuery_view.value = "";
	exceptQuery_view.value = "";
	searchForm.targetSiteId.value = targetSiteId;
}



//날짜
function goRange(range){
	var searchForm = document.forms.totalSearchForm;
	searchForm.range.value = range;

	if(range == "U"){
		detailDate();
	}else {
		
	//
		
		var startDate = "";
		var endDate = "";
		var currentDate = new Date();
		var year = currentDate.getFullYear();
		var month = currentDate.getMonth() +1;
		var day = currentDate.getDate();

		if (parseInt(month) < 10) {
			month = "0" + month;
		}

		if (parseInt(day) < 10) {
			day = "0" + day;
		}

		var toDate = year + "/" + month + "/" + day;

		if (range == "D") {
			startDate = getAddDay(currentDate, -0);
		
		} else if (range == "W") {
			startDate = getAddDay(currentDate, -6);
		
		} else if (range == "M") {
			startDate = getAddDay(currentDate, -29);
		} else if (range == "Y") {
			startDate = getAddDay(currentDate, -364);
		} else {
			startDate = "1970/01/01";
			endDate = toDate;
		}
		if (range != "A" && startDate != "") { 
			year = startDate.getFullYear();
			month = startDate.getMonth()+1; 
			day = startDate.getDate();

			if (parseInt(month) < 10) {
				month = "0" + month;
			}

			if (parseInt(day) < 10) {
				day = "0" + day;
			}

			startDate = year + "/" + month + "/" + day;				
			endDate = toDate;
		}
		$("#startDate").val(startDate);
		$("#endDate").val(endDate);
		searchForm.targetSiteId.value = targetSiteId;
		searchForm.coll_id.value = coll_id;
		searchForm.popwordCollection.value = popwordCollection;
		onSubmit();
	}
}

// 날짜 계산
function getAddDay ( targetDate, dayPrefix ){
	var newDate = new Date( );
	var processTime = targetDate.getTime ( ) + ( parseInt ( dayPrefix ) * 24 * 60 * 60 * 1000 );
	newDate.setTime ( processTime );
	return newDate;
}

// 검색필드
function goSearchField(searchField){
	var searchForm = document.forms.totalSearchForm;
	searchForm.searchField.value = searchField;
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	onSubmit();
}

// 정렬
function goSortField(sortField, sortOrder){
	var searchForm = document.forms.totalSearchForm;
	searchForm.sortField.value = sortField;
	searchForm.sortOrder.value =sortOrder;
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	onSubmit();
}
// 정렬
function goSortField(sortField, sortOrder){
	var searchForm = document.forms.totalSearchForm;
	searchForm.sortField.value = sortField;
	searchForm.sortOrder.value =sortOrder;
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	onSubmit();
}

// 페이징
	function goPage(count) {
		var searchForm = document.forms.totalSearchForm;
		searchForm.startCount.value = count;
		searchForm.targetSiteId.value = targetSiteId;
		onSubmit();
	}

// 더보기
function goCollection(collectionName , Gbn){
	var searchForm = document.forms.totalSearchForm;
	searchForm.collectionGbn.value = Gbn;
	searchForm.collection.value =collectionName;
	searchForm.viewCount.value="10";
	searchForm.startCount.value="0";
	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	//searchForm.treeDept_websiteIF.value = "";
	searchForm.treeDept_portal_naver.value = "";
	searchForm.treeDept_portal_daum.value = "";
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	
	onSubmit();
}

// 더보기
function goCollection_portal(collectionName , Gbn ,treeDept_portal ){
	var searchForm = document.forms.totalSearchForm;
	searchForm.collectionGbn.value = Gbn;
	searchForm.collection.value =collectionName;
	searchForm.viewCount.value="10";
	searchForm.startCount.value="0";
	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	//searchForm.treeDept_websiteIF.value = "";
	if(collectionName == "naver"){
		searchForm.treeDept_portal_naver.value = treeDept_portal;
		searchForm.treeDept_portal_daum.value = "";
	}else if(collectionName == "daum"){
		searchForm.treeDept_portal_naver.value = "";
		searchForm.treeDept_portal_daum.value = treeDept_portal;
	}
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	
	
	onSubmit();
}


//좌측 트리구조별 업무구분값 설정
function collectionGbn(gbn){
	var searchForm = document.forms.totalSearchForm;

	if(gbn == "0"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "ALL";
		searchForm.viewCount.value="3";
	}else if(gbn == "1"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "menu";
		searchForm.viewCount.value="10";
	}else if(gbn == "2"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "emp";
		searchForm.viewCount.value="10";
	}else if(gbn == "3"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "naver,daum";
		searchForm.viewCount.value="3";
	}else if(gbn == "4"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "websiteIF";
		searchForm.viewCount.value="10";
	}else if(gbn == "5"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "issue";
		searchForm.viewCount.value="10";
	}else if(gbn == "6"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "library";
		searchForm.viewCount.value="10";
	}else if(gbn == "7"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "notice";
		searchForm.viewCount.value="10";
	}else if(gbn == "8"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "policy";
		searchForm.viewCount.value="10";
	}else if(gbn == "9"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "statute";
		searchForm.viewCount.value="10";
	}else if(gbn == "10"){
		searchForm.collectionGbn.value = gbn;
		searchForm.collection.value = "openinfo";
		searchForm.viewCount.value="10";
	}else {
		searchForm.collectionGbn.value = "0";
		searchForm.collection.value = "ALL";
		searchForm.viewCount.value="3";
	}

	searchForm.startCount.value="0";
	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	//searchForm.treeDept_websiteIF.value = "";
	searchForm.treeDept_portal_naver.value = "";
	searchForm.treeDept_portal_daum.value = "";
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	
	
	
	onSubmit();

}

// 우측 트리구조 조건
function treeDept(collection,exquery){
	var searchForm = document.forms.totalSearchForm;

	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	//searchForm.treeDept_websiteIF.value = "";
	searchForm.treeDept_portal_naver.value = "";
	searchForm.treeDept_portal_daum.value = "";

	searchForm.collection.value = collection;
	searchForm.viewCount.value="10";
	searchForm.startCount.value="0";
	if(collection == "openinfo"){
		searchForm.treeDept_openinfo.value = exquery;
	}else if(collection == "issue"){
		searchForm.treeDept_issue.value = exquery;
	}else if(collection == "notiadv1"){
		searchForm.treeDept_notiadv1.value = exquery;
	}else if(collection == "notiadv2"){
		searchForm.treeDept_notiadv2.value = exquery;
	}else if(collection == "emp"){
		searchForm.treeDept_emp.value = exquery;
	}else if(collection == "websiteIF"){
		searchForm.treeDept_websiteIF.value = exquery;
	}else if(collection == "naver" ){
		searchForm.treeDept_portal_naver.value = exquery;
	}else if( collection == "daum"){
		searchForm.treeDept_portal_daum.value = exquery;
	}
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	

	onSubmit();
}



//
function goSearch(){
	var searchForm = document.forms.totalSearchForm;
	var query = document.getElementById("sckeyword").value;
	if(trim(query) == ""){
		alert("검색어를 입력하세요");
		return false;
	}
	searchForm.sckeyword.value = query;
	
	//searchForm.collectionGbn.value = "0";
	//searchForm.collection.value = "ALL";
	//searchForm.startCount.value="0";
	//searchForm.viewCount.value="2";
	/*
	searchForm.sortField.value="";
	searchForm.sortOrder.value="";
	searchForm.searchField.value="";
	searchForm.range.value="";
	searchForm.startDate.value="";
	searchForm.endDate.value="";
	*/

	/*
	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_policylaw1.value = "";
	searchForm.treeDept_policylaw2.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	searchForm.treeDept_websiteIF.value = "";
	searchForm.treeDept_portal_naver.value = "";
	searchForm.treeDept_portal_daum.value = "";
	*/

	// 상세검색쪽 초기화
	//searchForm.matchQuery.value = "";
	//searchForm.indexOfQuery.value = "";
	//searchForm.exceptQuery.value = "";
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;



	searchForm.submit();
}

function doSearchReSet(){
	var searchForm = document.forms.totalSearchForm;
	searchForm.collectionGbn.value = "0";
	searchForm.collection.value = "ALL";
	searchForm.startCount.value="0";
	searchForm.viewCount.value="3";
	searchForm.sortField.value="";
	searchForm.sortOrder.value="";
	searchForm.searchField.value="";
	searchForm.range.value="";
	searchForm.startDate.value="";
	searchForm.endDate.value="";

	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	//searchForm.treeDept_websiteIF.value = "";
	searchForm.treeDept_portal_naver.value = "";
	searchForm.treeDept_portal_daum.value = "";

	// 상세검색쪽 초기화
	searchForm.matchQuery.value = "";
	searchForm.indexOfQuery.value = "";
	searchForm.exceptQuery.value = "";
	//인기검색어
	searchForm.popwordRange.value="";
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;

	searchForm.submit();
}


// form  전송
function onSubmit(){
	var searchForm = document.forms.totalSearchForm;
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.submit();
}

//결과내 재검색  
function onresearch() {   
	var searchForm = document.forms.totalSearchForm;
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	//alert(document.getElementById("internet").checked);
	if(document.getElementById("internet").checked){ // 선택
		searchForm.rt.value = "1";
		searchForm.requery.value = document.getElementById("viewQuery").value ;
		document.getElementById("viewQuery").value  = "";
	}else{
		searchForm.rt.value = "0";
		document.getElementById("viewQuery").value = searchForm.requery.value;
		searchForm.requery.value = "";
	}
}

// 인기검색어, 내가찾은 검색어
function doKeyword(query) {
	var searchForm = document.forms.totalSearchForm; 

	searchForm.collectionGbn.value = "0";
	searchForm.collection.value = "ALL";
	searchForm.startCount.value = "0";
	searchForm.viewCount.value="3";
	searchForm.treeDept_openinfo.value = "";
	searchForm.treeDept_issue.value = "";
	searchForm.treeDept_notiadv1.value = "";
	searchForm.treeDept_notiadv2.value = "";
	searchForm.treeDept_emp.value = "";
	//searchForm.treeDept_websiteIF.value = "";
	searchForm.treeDept_portal_naver.value = "";
	searchForm.treeDept_portal_daum.value = "";

	searchForm.query.value = query;
	searchForm.sortField.value = "RANK";
	searchForm.sortOrder.value = "1";

	// 상세검색쪽 초기화
	searchForm.matchQuery.value = "";
	searchForm.indexOfQuery.value = "";
	searchForm.exceptQuery.value = "";
	searchForm.targetSiteId.value = targetSiteId;
	searchForm.coll_id.value = coll_id;
	searchForm.popwordCollection.value = popwordCollection;
	
	searchForm.submit();
	
	//doSearch();
}


// 쿠키값 조회
function getCookie(c_name) {
	var i,x,y,cookies=document.cookie.split(";");
	for (i=0;i<cookies.length;i++) {
		x=cookies[i].substr(0,cookies[i].indexOf("="));
		y=cookies[i].substr(cookies[i].indexOf("=")+1);
		x=x.replace(/^\s+|\s+$/g,"");
	
		if (x==c_name) {
			return unescape(y);
		}
	}
}

// 쿠키값 설정
function setCookie(c_name,value,exdays) {
	var exdate=new Date();
	exdate.setDate(exdate.getDate() + exdays);
	var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
	document.cookie=c_name + "=" + c_value;
}
//메인화면 내가 찾은 검색어 등록
//function setMyKeyword(){
	//var keyword = $('#sckeyword').val();
	//getMyKeyword(keyword, 0);
//}
//메인화면 내가 찾은 검색어 show
//function settingMyKeyword(){
	//var MYKEYWORD_COUNT = 11; //내가 찾은 검색어 갯수 + 1
	//var myKeyword = getCookie("mykeyword");
	//if( myKeyword== null) {
	//	myKeyword = "";
	//}

	//var myKeywords = myKeyword.split("^%");
	
	//if( myKeywords.length == MYKEYWORD_COUNT) {
			//myKeywords = myKeywords.slice(1,MYKEYWORD_COUNT);
	//}
	//setCookie("mykeyword", myKeywords.join("^%"), 365);
	

	//showMyKeyword(myKeywords.reverse());
	//console.log(myKeywords.reverse());
//}

// 내가 찾은 검색어 조회
function getMyKeyword(keyword, totCount) {
	var MYKEYWORD_COUNT = 11; //내가 찾은 검색어 갯수 + 1
	//var MYKEYWORD_COUNT = 11; //내가 찾은 검색어 갯수 + 1
	var myKeyword = getCookie("mykeyword");
	if( myKeyword== null) {
		myKeyword = "";
	}

	
	var myKeywords = myKeyword.split("^%");

	
	var existsKeyword = false;
	for( var i = 0; i < myKeywords.length; i++) {
		if( myKeywords[i] == keyword) {
			existsKeyword = true;
			break;
		}
	}

	if( !existsKeyword ) {
		myKeywords.push(keyword);
		if( myKeywords.length == MYKEYWORD_COUNT) {
			myKeywords = myKeywords.slice(1,MYKEYWORD_COUNT);
		}
	}
	setCookie("mykeyword", myKeywords.join("^%"), 365);
	

	showMyKeyword(myKeywords.reverse());
}


// 내가 찾은 검색어 삭제
function removeMyKeyword(keyword) {
	var myKeyword = getCookie("mykeyword");
	if( myKeyword == null) {
		myKeyword = "";
	}

	var myKeywords = myKeyword.split("^%");

	var i = 0;
	while (i < myKeywords.length) {
		if (myKeywords[i] == keyword) {
			myKeywords.splice(i, 1);
		} else { 
			i++; 
		}
	}

	setCookie("mykeyword", myKeywords.join("^%"), 365);

	showMyKeyword(myKeywords);
}
//내가 찾은 검색어 전체삭제
function removeAllMyKeyword() {
	var myKeyword = "";
	var myKeywords = myKeyword.split("^%");
	setCookie("mykeyword", myKeywords.join("^%"), 365);
	
	showMyKeyword(myKeywords);
}

 
// 내가 찾은 검색어 
function showMyKeyword(myKeywords) {
	var str = "";

	for( var i = 0; i < myKeywords.length; i++) {
		if( myKeywords[i].trim() == "") continue;
		str +="<li>";
		str +="<div class=\"popular_delete_wrap\">";
		str +="<a href=\"javascript:doKeyword('"+myKeywords[i]+"');\"><span class=\"popular_delete_txt\">"+myKeywords[i]+"</span></a>";
		str +="<a href=\"javascript:removeMyKeyword('"+myKeywords[i]+"');\"><span class=\"popular_delete_img\"><img src=\"./images/search/icon_search_delete.gif\" alt=\"삭제\"/></span></a>";
		str +="</div>";
		str +="</li>";
	}

	$("#mykeyword").html(str);
}

function getPopkeyword(Range) {

	//var target		= "popword";
	//var range		= "W";
	//var collection  = "_ALL_";
   // var datatype   = "xml";
    var popwordCollection = "_Main_";

	$.ajax({
	  type: "POST",
	  link: "./popword/popword_new.jsp",
	  dataType: "json",
	    //data: {"popwordCollection":popwordCollection,"popwordRange":popwordRange }, 
	   data: {"popwordRange":Range }, 
 	   success: function(json) {
	
		var str = "";
		var query = json.Data.Query;
		
		$(query).each(function(num){
			str += "<li>";
			str += "<div class=\"popular_list_wrap\">";
			str += "<span class=\"popular_count\"><em>"+$(this).attr("id")+"</em></span>";
			str += "<a href=\"javascript:doKeyword('"+$(this).attr("content")+"')\"><span class=\"popular_list_txt\">"+$(this).attr("content")+"</span></a>";
			if ($(this).attr("updown") == "U") {
				//str += "<span class=\"popular_up\">";
			} else if ($(this).attr("updown") == "D") {
				//str += "<span class=\"popular_down\">";
			} else if ($(this).attr("updown") == "N") {
				//str += "<span class=\"popular_delete_wrap\">";
			} else if ($(this).attr("updown") == "C") {
				//str += "<span class=\"popular_delete_wrap\">";
			}

			str += "<span class=\"blind\">";
			if ($(this).attr("updown") == "U") {
				//str += "상승";
			} else if ($(this).attr("updown") == "D") {
				//str += "하락";
			} else if ($(this).attr("updown") == "N") {
				//str += "신규";
			} else if ($(this).attr("updown") == "C") {
				//str += "-";
			}
			str += "</span>";
			str +="<span>" ;
			if ($(this).attr("updown") == "U") {
				//str+= $(this).attr("count");
			} else if ($(this).attr("updown") == "D") {
				//str+= $(this).attr("count");
			} else if ($(this).attr("updown") == "N") {
				
			} else if ($(this).attr("updown") == "C") {
				
			}
		
			//str +="</span>";
			str += "</span>";
			str += "</div>";
			str += "</li>";
		});
		$("#popword").html(str);
		if($(query).length == 0){
			str += "인기검색어가 없습니다.";
			$("#popword").html(str);
		}
	  }
	  
	});
}

function getRelationKeyword(_query) {
	
	var api_type	= "keyword";
	var coll_id		= "me";
	var query		= _query;
	var keywordCount = "5";
	$.ajax({
		type: "POST",
		link: "./tea/teaGraphApi.jsp",
		dataType: "json",
		data: { "api_type" : api_type,"query" : query ,"keyword":query,"num_relation_keyword":5 },
		success: function(json) {	
			console.log(json)	
			var str = "";
			var RelationKeyword_Str = json.Response[0].RelationKeyword;
			//alert(RelationKeyword_Str);
			var RelationKeyword_Arr = RelationKeyword_Str.split('^');
			if(RelationKeyword_Arr[0] != "" ){
				str += "<header>연관검색어</header>";
				str += "<ul>";
				for (i=0 ; i < RelationKeyword_Arr.length ; i++){
					str += "<li><a href=\"javascript:doKeyword('"+RelationKeyword_Arr[i]+"');\">"+RelationKeyword_Arr[i]+"</a></li>";
				}
				str += "</ul>";
			}	
			$("#relationKeyword").html(str);
			
			//console.log("str == "+str);

			if(str=="") { $("#relationKeyword").hide(); }

			str = "";
			if(RelationKeyword_Arr[0] != "" ){
				str += "<header>연관검색어</header>";
				str += "<div class=\"popular_folding\">";
				str += "<ol>";
				for (i=0 ; i < RelationKeyword_Arr.length ; i++){
					str += "<li>";
					str += "	<div class=\"popular_list_wrap\">";
					str += "		<span class=\"popular_count\"><em>"+(i+1)+"</em></span>";
					str += "		<a href=\"javascript:doKeyword('"+RelationKeyword_Arr[i]+"');\"><span>"+RelationKeyword_Arr[i]+"</span></a>";
					str += "	</div>";
					str += "</li>";
				}
				str += "</ol>";
				str += "</div>";
			}
			$("#relationKeyword2").html(str);

			
		}
	});
}


// Replace All
function replaceAll(str, orgStr, repStr) {
	return str.split(orgStr).join(repStr);
}

// 공백 제거
function trim(str) {
	return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
}